<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pre-Handover Portal Settings - OpenHouse</title>
  
  <!-- EXTERNAL DEPENDENCIES -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- TAILWIND CONFIG - Edit brand colours here -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              gold: '#D4A853',
              dark: '#1a1a1a',
            }
          }
        }
      }
    }
  </script>
  
  <!-- 
  ============================================
  STYLES - SAFE TO MODIFY FOR DESIGN CHANGES
  ============================================
  -->
  <style>
    /* Base */
    * { font-family: 'Inter', -apple-system, sans-serif; }
    
    /* Cards */
    .card { 
      background: white; 
      border: 1px solid #e5e7eb; 
      border-radius: 12px; 
    }
    
    /* Form Inputs */
    .input-field {
      width: 100%; 
      padding: 10px 14px; 
      border: 1px solid #e5e7eb; 
      border-radius: 8px;
      font-size: 14px; 
      transition: all 0.15s ease; 
      background: white;
    }
    .input-field:focus { 
      outline: none; 
      border-color: #D4A853; 
      box-shadow: 0 0 0 3px rgba(212, 168, 83, 0.1); 
    }
    
    /* Textareas */
    .textarea-field {
      width: 100%; 
      padding: 10px 14px; 
      border: 1px solid #e5e7eb; 
      border-radius: 8px;
      font-size: 14px; 
      resize: vertical; 
      min-height: 80px; 
      transition: all 0.15s ease; 
      background: white;
    }
    .textarea-field:focus { 
      outline: none; 
      border-color: #D4A853; 
      box-shadow: 0 0 0 3px rgba(212, 168, 83, 0.1); 
    }
    
    /* Primary Button */
    .btn-primary {
      background: #D4A853; 
      color: white; 
      padding: 10px 20px; 
      border-radius: 8px;
      font-weight: 500; 
      font-size: 14px; 
      transition: all 0.15s ease; 
      cursor: pointer; 
      border: none;
    }
    .btn-primary:hover { background: #c49843; }
    
    /* Secondary Button */
    .btn-secondary {
      background: white; 
      color: #374151; 
      padding: 10px 20px; 
      border-radius: 8px;
      font-weight: 500; 
      font-size: 14px; 
      border: 1px solid #e5e7eb; 
      transition: all 0.15s ease; 
      cursor: pointer;
    }
    .btn-secondary:hover { 
      background: #f9fafb; 
      border-color: #d1d5db; 
    }
    
    /* Toggle Switch */
    .toggle {
      position: relative; 
      width: 44px; 
      height: 24px; 
      background: #e5e7eb; 
      border-radius: 12px;
      transition: background 0.2s ease; 
      cursor: pointer; 
      flex-shrink: 0; 
      border: none;
    }
    .toggle.active { background: #D4A853; }
    .toggle::after {
      content: ''; 
      position: absolute; 
      top: 2px; 
      left: 2px; 
      width: 20px; 
      height: 20px;
      background: white; 
      border-radius: 10px; 
      transition: transform 0.2s ease; 
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .toggle.active::after { transform: translateX(20px); }
    
    /* Milestone Row */
    .milestone-item {
      background: #f9fafb; 
      border: 2px solid #e5e7eb; 
      border-radius: 8px;
      padding: 12px 16px; 
      display: flex; 
      align-items: center; 
      gap: 12px; 
      transition: all 0.15s ease;
    }
    .milestone-item:hover { border-color: #d1d5db; }
    .milestone-item.disabled-item { opacity: 0.5; }
    
    /* FAQ Item */
    .faq-item { 
      background: #f9fafb; 
      border: 1px solid #e5e7eb; 
      border-radius: 8px; 
      padding: 16px; 
      transition: all 0.15s ease; 
    }
    .faq-item:hover { border-color: #d1d5db; }
    
    /* Checkbox */
    .checkbox-field {
      width: 18px; 
      height: 18px; 
      border-radius: 4px; 
      border: 2px solid #d1d5db;
      cursor: pointer; 
      transition: all 0.15s ease; 
      appearance: none; 
      background: white;
    }
    .checkbox-field:checked { 
      background: #D4A853; 
      border-color: #D4A853; 
    }
    .checkbox-field:checked::after {
      content: '✓'; 
      display: block; 
      text-align: center; 
      color: white;
      font-size: 12px; 
      font-weight: bold; 
      line-height: 14px;
    }
    
    /* Add Button (text style) */
    .add-btn {
      display: inline-flex; 
      align-items: center; 
      gap: 6px; 
      padding: 8px 16px;
      font-size: 14px; 
      font-weight: 500; 
      color: #6b7280; 
      background: transparent;
      border: none; 
      cursor: pointer; 
      transition: all 0.15s ease;
    }
    .add-btn:hover { color: #D4A853; }
    
    /* Delete Button */
    .delete-btn { 
      background: none; 
      border: none; 
      cursor: pointer; 
      padding: 4px; 
      border-radius: 4px; 
      transition: all 0.15s ease; 
    }
    .delete-btn:hover { background: #fee2e2; }
    .delete-btn:hover svg { color: #dc2626; }
    
    /* Drag and Drop */
    .drag-handle { cursor: grab; }
    .drag-handle:active { cursor: grabbing; }
    .dragging { opacity: 0.5; background: #fef3c7; }
    .drag-over { border-color: #D4A853 !important; background: rgba(212, 168, 83, 0.1) !important; }
    
    /* Toast Notification */
    .toast {
      position: fixed; 
      bottom: 24px; 
      right: 24px; 
      background: #1a1a1a; 
      color: white;
      padding: 12px 20px; 
      border-radius: 8px; 
      font-size: 14px; 
      font-weight: 500;
      transform: translateY(100px); 
      opacity: 0; 
      transition: all 0.3s ease; 
      z-index: 100;
    }
    .toast.show { transform: translateY(0); opacity: 1; }
    
    /* 
    ============================================
    PHONE PREVIEW STYLES
    ============================================
    */
    .preview-phone {
      width: 280px; 
      height: 580px; 
      background: linear-gradient(180deg, #FAF8F3 0%, #F5F1EA 100%);
      border-radius: 32px; 
      border: 8px solid #1a1a1a; 
      overflow: hidden; 
      position: relative;
    }
    .preview-notch {
      position: absolute; 
      top: 0; 
      left: 50%; 
      transform: translateX(-50%);
      width: 120px; 
      height: 28px; 
      background: #1a1a1a; 
      border-radius: 0 0 16px 16px; 
      z-index: 10;
    }
    
    /* Phone Bottom Sheets */
    .phone-sheet {
      position: absolute; 
      bottom: 0; 
      left: 0; 
      right: 0; 
      background: linear-gradient(180deg, #FFFFFF 0%, #FAF8F3 100%);
      border-radius: 16px 16px 0 0; 
      transform: translateY(100%); 
      transition: transform 0.3s cubic-bezier(0.32, 0.72, 0, 1);
      box-shadow: 0 -4px 20px rgba(0,0,0,0.15); 
      z-index: 20; 
      max-height: 75%;
    }
    .phone-sheet.open { transform: translateY(0); }
    
    .phone-sheet-backdrop {
      position: absolute; 
      inset: 0; 
      background: rgba(0,0,0,0.3); 
      opacity: 0;
      pointer-events: none; 
      transition: opacity 0.3s ease; 
      z-index: 15;
    }
    .phone-sheet-backdrop.open { opacity: 1; pointer-events: auto; }
    
    /* Phone Interactive Elements */
    .phone-action-btn { 
      cursor: pointer; 
      transition: all 0.15s ease; 
    }
    .phone-action-btn:hover { transform: scale(1.05); }
    .phone-action-btn:active { transform: scale(0.95); }
    
    .phone-nav-btn { 
      cursor: pointer; 
      transition: all 0.1s ease; 
    }
    .phone-nav-btn:active { opacity: 0.7; }
    .phone-nav-btn.active svg { color: #D4A853; }
    .phone-nav-btn.active span { color: #D4A853; font-weight: 600; }
    
    /* Phone Scroll (hide scrollbar, enable drag) */
    .phone-scroll {
      overflow-y: auto;
      scrollbar-width: none;
      -ms-overflow-style: none;
      cursor: grab;
    }
    .phone-scroll::-webkit-scrollbar { display: none; }
    .phone-scroll.dragging { cursor: grabbing; user-select: none; }
    
    /* Pulsing animation for current milestone */
    @keyframes pulse-gold {
      0%, 100% { box-shadow: 0 0 0 0 rgba(212, 168, 83, 0.4); }
      50% { box-shadow: 0 0 0 4px rgba(212, 168, 83, 0); }
    }
    .pulse-gold { animation: pulse-gold 2s ease-in-out infinite; }
  </style>
</head>

<body class="bg-gray-50 min-h-screen">
  
  <!-- Toast Notification -->
  <div id="toast" class="toast"><span id="toast-message">Changes saved!</span></div>
  
  <!-- 
  ============================================
  MAIN CONTENT - Structure can be modified but keep IDs
  ============================================
  -->
  <main class="px-8 py-8">
    <div class="max-w-6xl mx-auto">
      
      <!-- Page Header -->
      <div class="flex items-start justify-between mb-8">
        <div>
          <h1 class="text-2xl font-bold text-gray-900">Pre-Handover Portal Settings</h1>
          <p class="text-gray-500 mt-1">Customise the experience purchasers see before their property is handed over.</p>
        </div>
        <div class="flex items-center gap-3">
          <button class="btn-secondary" id="preview-btn">Preview Portal</button>
          <button class="btn-primary" id="save-btn">Save Changes</button>
        </div>
      </div>
      
      <div class="grid grid-cols-3 gap-8">
        
        <!-- LEFT COLUMN: Configuration Forms -->
        <div class="col-span-2 space-y-6">
          
          <!-- Welcome Message Section -->
          <div class="card p-6">
            <div class="mb-4">
              <h3 class="font-semibold text-gray-900">Welcome Message</h3>
              <p class="text-sm text-gray-500 mt-0.5">Personalised greeting shown to purchasers</p>
            </div>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1.5">Greeting</label>
                <input type="text" id="greeting-input" class="input-field" value="Welcome to your new home journey" placeholder="e.g., Welcome to Rathard Park">
                <p class="text-xs text-gray-400 mt-1.5">The purchaser's name is added automatically: "<span id="greeting-hint">Welcome to your new home journey</span>, <strong>Sarah</strong>"</p>
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1.5">Introduction Text</label>
                <textarea id="intro-input" class="textarea-field" placeholder="Optional welcome paragraph...">We're excited to be part of your journey to your new home at Rathard Park. This portal will keep you updated on your progress from sale agreed through to getting your keys.</textarea>
              </div>
            </div>
          </div>
          
          <!-- Key Dates Section -->
          <div class="card p-6">
            <div class="mb-4">
              <h3 class="font-semibold text-gray-900">Key Dates</h3>
              <p class="text-sm text-gray-500 mt-0.5">Default estimated dates and calendar options</p>
            </div>
            <div class="space-y-4">
              <div class="grid grid-cols-2 gap-4">
                <div class="flex-1">
                  <label class="block text-sm font-medium text-gray-700 mb-1.5">Est. Handover Month</label>
                  <select id="est-handover-input" class="input-field">
                    <option value="">Select month...</option>
                    <option value="2026-01">January 2026</option>
                    <option value="2026-02">February 2026</option>
                    <option value="2026-03" selected>March 2026</option>
                    <option value="2026-04">April 2026</option>
                    <option value="2026-05">May 2026</option>
                    <option value="2026-06">June 2026</option>
                    <option value="2026-07">July 2026</option>
                    <option value="2026-08">August 2026</option>
                    <option value="2026-09">September 2026</option>
                    <option value="2026-10">October 2026</option>
                    <option value="2026-11">November 2026</option>
                    <option value="2026-12">December 2026</option>
                    <option value="2027-01">January 2027</option>
                    <option value="2027-02">February 2027</option>
                    <option value="2027-03">March 2027</option>
                  </select>
                </div>
                <div class="flex-1">
                  <label class="block text-sm font-medium text-gray-700 mb-1.5">Default Snagging Lead Time</label>
                  <select id="snagging-lead-input" class="input-field">
                    <option value="2">2 weeks before handover</option>
                    <option value="3" selected>3 weeks before handover</option>
                    <option value="4">4 weeks before handover</option>
                  </select>
                </div>
              </div>
              <p class="text-xs text-gray-400">Shown in status badge. Override per unit in Sales Pipeline.</p>
              
              <div class="pt-2 border-t border-gray-100">
                <label class="block text-sm font-medium text-gray-700 mb-3">Calendar Integration</label>
                <p class="text-xs text-gray-500 mb-3">Allow purchasers to add key dates to their calendar</p>
                <div class="flex flex-wrap gap-4">
                  <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="cal-google" class="checkbox-field" checked>
                    <span class="text-sm text-gray-700">Google Calendar</span>
                  </label>
                  <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="cal-apple" class="checkbox-field" checked>
                    <span class="text-sm text-gray-700">Apple Calendar</span>
                  </label>
                  <label class="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" id="cal-outlook" class="checkbox-field" checked>
                    <span class="text-sm text-gray-700">Outlook</span>
                  </label>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Milestones Section -->
          <div class="card p-6">
            <div class="mb-4">
              <h3 class="font-semibold text-gray-900">Journey Milestones</h3>
              <p class="text-sm text-gray-500 mt-0.5">Configure which milestones appear in the purchaser's timeline.</p>
            </div>
            <div class="space-y-2" id="milestone-list">
              <!-- Rendered by JavaScript -->
            </div>
            <button class="add-btn mt-3" id="add-milestone-btn">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
              Add Custom Milestone
            </button>
          </div>
          
          <!-- FAQs Section -->
          <div class="card p-6">
            <div class="mb-4">
              <h3 class="font-semibold text-gray-900">Frequently Asked Questions</h3>
              <p class="text-sm text-gray-500 mt-0.5">Common questions shown in the FAQ section</p>
            </div>
            <div class="space-y-3" id="faq-list">
              <!-- Rendered by JavaScript -->
            </div>
            <button class="add-btn mt-3" id="add-faq-btn">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" /></svg>
              Add FAQ
            </button>
          </div>
          
          <!-- Contact Information Section -->
          <div class="card p-6">
            <div class="mb-4">
              <h3 class="font-semibold text-gray-900">Contact Information</h3>
              <p class="text-sm text-gray-500 mt-0.5">Contact details shown to purchasers in the portal.</p>
            </div>
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1.5">Sales Phone Number</label>
                <input type="tel" id="phone-input" class="input-field" value="+353 21 456 7890" placeholder="+353 21 456 7890">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1.5">Sales Email</label>
                <input type="email" id="email-input" class="input-field" value="sales@rathardpark.ie" placeholder="sales@development.ie">
              </div>
              <div class="col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-1.5">Show House Address</label>
                <input type="text" id="address-input" class="input-field" value="Rathard Park, Bishopstown, Cork" placeholder="123 Main Street, Cork">
              </div>
            </div>
          </div>
          
          <!-- Status Messages Section -->
          <div class="card p-6">
            <div class="mb-4">
              <h3 class="font-semibold text-gray-900">Status Messages</h3>
              <p class="text-sm text-gray-500 mt-0.5">Custom messages for different statuses</p>
            </div>
            <div class="space-y-4">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1.5">
                  <span class="inline-flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-emerald-500"></span>On Track Message</span>
                </label>
                <input type="text" id="ontrack-input" class="input-field" value="On Track">
              </div>
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-1.5">
                  <span class="inline-flex items-center gap-2"><span class="w-2 h-2 rounded-full bg-amber-500"></span>Delayed Message</span>
                </label>
                <input type="text" id="delayed-input" class="input-field" value="Slight Delay">
              </div>
            </div>
          </div>
          
        </div>
        
        <!-- RIGHT COLUMN: Phone Preview -->
        <div class="col-span-1">
          <div class="sticky top-8">
            <div class="flex items-center justify-between mb-4">
              <h3 class="font-semibold text-gray-900">Live Preview</h3>
              <span class="text-xs text-gray-400">Tap to interact</span>
            </div>
            
            <!-- Phone Device Frame -->
            <div class="preview-phone" id="preview-phone">
              <div class="preview-notch"></div>
              <div class="phone-sheet-backdrop" id="phone-backdrop"></div>
              
              <div class="h-full pt-10 pb-4 px-4 flex flex-col overflow-hidden relative">
                
                <!-- Phone Header -->
                <div class="flex items-center justify-between py-3">
                  <div>
                    <p class="text-[10px] text-gray-500" id="preview-time-greeting">Good afternoon</p>
                    <p class="text-sm font-semibold text-gray-900">My Home</p>
                  </div>
                  <div class="w-7 h-7 rounded-lg bg-white/60 border border-white flex items-center justify-center phone-action-btn" id="btn-settings">
                    <svg class="w-3.5 h-3.5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                    </svg>
                  </div>
                </div>
                
                <!-- Phone Main Content (Scrollable) -->
                <div class="flex-1 flex flex-col items-center pt-2 overflow-auto phone-scroll" id="phone-main-content">
                  
                  <!-- Welcome Greeting -->
                  <p class="text-[10px] text-gray-600 mb-2 text-center px-2" id="preview-greeting">Welcome to your new home journey, <strong>Sarah</strong></p>
                  
                  <!-- Property Card -->
                  <div class="bg-white/70 backdrop-blur rounded-2xl p-4 w-full text-center shadow-sm border border-white/80">
                    <div class="w-12 h-12 mx-auto mb-3 rounded-full bg-gradient-to-br from-brand-gold/20 to-brand-gold/5 flex items-center justify-center border border-brand-gold/20">
                      <div class="w-8 h-8 rounded-full bg-gradient-to-br from-brand-gold to-amber-600 flex items-center justify-center">
                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M12 3L4 9v12h5v-7h6v7h5V9l-8-6z"/></svg>
                      </div>
                    </div>
                    <p class="font-serif text-base text-gray-900" style="font-family: Georgia, serif;">14 Rathard Park</p>
                    <p class="text-[10px] text-gray-500 mt-0.5">3 Bed Semi-Detached · Type B</p>
                    <div class="mt-3 inline-flex items-center gap-1.5 px-2.5 py-1.5 bg-emerald-50 border border-emerald-100 rounded-full">
                      <span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span>
                      <span class="text-[10px] font-medium text-emerald-700" id="preview-status">On Track · Est. Mar 2026</span>
                    </div>
                    <div class="my-3 h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent"></div>
                    <div class="text-left">
                      <div class="flex items-center justify-between mb-1.5">
                        <span class="text-[9px] font-medium text-gray-400 uppercase tracking-wider">Progress</span>
                        <span class="text-[10px] font-semibold text-brand-gold" id="preview-percent">66%</span>
                      </div>
                      <div class="h-1.5 rounded-full bg-gray-200 overflow-hidden">
                        <div class="h-full rounded-full bg-gradient-to-r from-brand-gold to-amber-400 transition-all duration-300" id="preview-progress-bar" style="width: 66%"></div>
                      </div>
                      <div class="mt-2 flex items-center justify-center gap-1.5">
                        <span class="w-1.5 h-1.5 rounded-full bg-brand-gold pulse-gold"></span>
                        <span class="text-[10px] text-gray-600" id="preview-current-milestone">
                          <span class="font-medium">Snagging</span>
                          <span class="text-gray-400"> · Est. 28 Jan</span>
                        </span>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Action Buttons Grid -->
                  <div class="grid grid-cols-4 gap-1.5 mt-3 w-full">
                    <div class="bg-white/70 rounded-xl p-2 text-center border border-white/80 phone-action-btn" id="btn-timeline">
                      <div class="w-6 h-6 mx-auto rounded-lg bg-violet-50 flex items-center justify-center mb-1">
                        <svg class="w-3 h-3 text-violet-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                      </div>
                      <span class="text-[8px] text-gray-600">Timeline</span>
                    </div>
                    <div class="bg-white/70 rounded-xl p-2 text-center border border-white/80 phone-action-btn" id="btn-docs">
                      <div class="w-6 h-6 mx-auto rounded-lg bg-blue-50 flex items-center justify-center mb-1">
                        <svg class="w-3 h-3 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                      </div>
                      <span class="text-[8px] text-gray-600">Docs</span>
                    </div>
                    <div class="bg-white/70 rounded-xl p-2 text-center border border-white/80 phone-action-btn" id="btn-faq">
                      <div class="w-6 h-6 mx-auto rounded-lg bg-amber-50 flex items-center justify-center mb-1">
                        <svg class="w-3 h-3 text-amber-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                      </div>
                      <span class="text-[8px] text-gray-600">FAQ</span>
                    </div>
                    <div class="bg-white/70 rounded-xl p-2 text-center border border-white/80 phone-action-btn" id="btn-contact">
                      <div class="w-6 h-6 mx-auto rounded-lg bg-emerald-50 flex items-center justify-center mb-1">
                        <svg class="w-3 h-3 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" /></svg>
                      </div>
                      <span class="text-[8px] text-gray-600">Contact</span>
                    </div>
                  </div>
                  
                  <!-- Key Dates Card -->
                  <div class="w-full mt-3 bg-white/70 rounded-xl p-3 border border-white/80 phone-action-btn" id="btn-calendar">
                    <div class="flex items-center justify-between">
                      <div class="flex items-center gap-2">
                        <div class="w-6 h-6 rounded-lg bg-rose-50 flex items-center justify-center">
                          <svg class="w-3 h-3 text-rose-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                        </div>
                        <div>
                          <p class="text-[10px] font-medium text-gray-900">Key Dates</p>
                          <p class="text-[8px] text-gray-500">Snagging, Handover</p>
                        </div>
                      </div>
                      <span class="text-[8px] text-brand-gold font-medium">Add to Calendar →</span>
                    </div>
                  </div>
                </div>
                
                <!-- Phone Bottom Navigation -->
                <div class="mt-auto pt-2 border-t border-gray-200/50 relative z-10 bg-gradient-to-t from-[#F5F1EA] to-transparent">
                  <div class="flex items-center justify-around">
                    <div class="text-center phone-nav-btn active" id="nav-home">
                      <svg class="w-5 h-5 mx-auto text-brand-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
                      <span class="text-[8px] font-medium text-brand-gold">Home</span>
                    </div>
                    <div class="text-center phone-nav-btn" id="nav-docs">
                      <svg class="w-5 h-5 mx-auto text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                      <span class="text-[8px] text-gray-400">Docs</span>
                    </div>
                    <div class="text-center phone-nav-btn" id="nav-faq">
                      <svg class="w-5 h-5 mx-auto text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                      <span class="text-[8px] text-gray-400">FAQ</span>
                    </div>
                  </div>
                </div>
                
                <!-- Phone Bottom Sheets -->
                <div class="phone-sheet" id="sheet-timeline">
                  <div class="p-4">
                    <div class="w-8 h-1 bg-gray-300 rounded-full mx-auto mb-3"></div>
                    <h3 class="font-semibold text-sm text-gray-900 mb-3">Your Timeline</h3>
                    <div id="sheet-timeline-content" class="space-y-2 max-h-[280px] overflow-auto phone-scroll"></div>
                  </div>
                </div>
                
                <div class="phone-sheet" id="sheet-docs">
                  <div class="p-4">
                    <div class="w-8 h-1 bg-gray-300 rounded-full mx-auto mb-3"></div>
                    <h3 class="font-semibold text-sm text-gray-900 mb-3">Documents</h3>
                    <div class="space-y-2">
                      <div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg">
                        <div class="w-8 h-8 rounded-lg bg-red-100 flex items-center justify-center">
                          <svg class="w-4 h-4 text-red-500" fill="currentColor" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z"/></svg>
                        </div>
                        <div class="flex-1">
                          <p class="text-[10px] font-medium text-gray-900">Floor Plans - Type B</p>
                          <p class="text-[8px] text-gray-500">PDF · 2.4 MB</p>
                        </div>
                      </div>
                      <div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg">
                        <div class="w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center">
                          <svg class="w-4 h-4 text-blue-500" fill="currentColor" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z"/></svg>
                        </div>
                        <div class="flex-1">
                          <p class="text-[10px] font-medium text-gray-900">Contract of Sale</p>
                          <p class="text-[8px] text-gray-500">PDF · 1.8 MB</p>
                        </div>
                      </div>
                      <div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg">
                        <div class="w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center">
                          <svg class="w-4 h-4 text-emerald-500" fill="currentColor" viewBox="0 0 24 24"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6z"/></svg>
                        </div>
                        <div class="flex-1">
                          <p class="text-[10px] font-medium text-gray-900">Kitchen Selections</p>
                          <p class="text-[8px] text-gray-500">PDF · 856 KB</p>
                        </div>
                      </div>
                    </div>
                    <p class="text-[8px] text-gray-400 mt-3 text-center">Documents matched to your house type</p>
                  </div>
                </div>
                
                <div class="phone-sheet" id="sheet-faq">
                  <div class="p-4">
                    <div class="w-8 h-1 bg-gray-300 rounded-full mx-auto mb-3"></div>
                    <h3 class="font-semibold text-sm text-gray-900 mb-3">FAQ</h3>
                    <div id="sheet-faq-content" class="space-y-2 max-h-[280px] overflow-auto phone-scroll"></div>
                  </div>
                </div>
                
                <div class="phone-sheet" id="sheet-contact">
                  <div class="p-4">
                    <div class="w-8 h-1 bg-gray-300 rounded-full mx-auto mb-3"></div>
                    <h3 class="font-semibold text-sm text-gray-900 mb-3">Contact Us</h3>
                    <div class="space-y-2" id="sheet-contact-content"></div>
                  </div>
                </div>
                
                <div class="phone-sheet" id="sheet-calendar">
                  <div class="p-4">
                    <div class="w-8 h-1 bg-gray-300 rounded-full mx-auto mb-3"></div>
                    <h3 class="font-semibold text-sm text-gray-900 mb-3">Add to Calendar</h3>
                    <div id="sheet-calendar-content" class="space-y-2"></div>
                  </div>
                </div>
                
                <div class="phone-sheet" id="sheet-settings">
                  <div class="p-4">
                    <div class="w-8 h-1 bg-gray-300 rounded-full mx-auto mb-3"></div>
                    <h3 class="font-semibold text-sm text-gray-900 mb-3">Settings</h3>
                    <div class="space-y-2">
                      <div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg">
                        <div class="w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center">
                          <svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" /></svg>
                        </div>
                        <div class="flex-1"><p class="text-[10px] font-medium text-gray-900">Notifications</p></div>
                      </div>
                      <div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg">
                        <div class="w-8 h-8 rounded-lg bg-violet-100 flex items-center justify-center">
                          <svg class="w-4 h-4 text-violet-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10" /></svg>
                        </div>
                        <div class="flex-1"><p class="text-[10px] font-medium text-gray-900">Language</p></div>
                      </div>
                      <div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg">
                        <div class="w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center">
                          <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        </div>
                        <div class="flex-1"><p class="text-[10px] font-medium text-gray-900">Help & Support</p></div>
                      </div>
                    </div>
                    <p class="text-[8px] text-gray-400 mt-4 text-center">OpenHouse v1.0.0</p>
                  </div>
                </div>
                
              </div>
            </div>
            
            <p class="text-xs text-gray-400 mt-4 text-center">Tap buttons to preview sheets. Data updates in real-time.</p>
          </div>
        </div>
        
      </div>
    </div>
  </main>
  
  <!-- 
  ============================================
  JAVASCRIPT - DO NOT MODIFY (handles all functionality)
  ============================================
  -->
  <script>
    // Configuration State
    var config = {
      greeting: "Welcome to your new home journey",
      introText: "We're excited to be part of your journey to your new home at Rathard Park.",
      estHandover: "2026-03",
      snaggingLead: "3",
      calendarOptions: { google: true, apple: true, outlook: true },
      milestones: [
        { id: 1, label: "Sale Agreed", enabled: true },
        { id: 2, label: "Contracts Signed", enabled: true },
        { id: 3, label: "Kitchen Selection", enabled: true },
        { id: 4, label: "Snagging", enabled: true },
        { id: 5, label: "Closing", enabled: true },
        { id: 6, label: "Handover", enabled: true }
      ],
      faqs: [
        { id: 1, question: "When will I get my keys?", answer: "Keys are handed over on closing day, after your solicitor confirms funds have transferred." },
        { id: 2, question: "What happens at snagging?", answer: "You'll walk through your home with our site manager to identify any minor defects." },
        { id: 3, question: "How do I set up electricity?", answer: "Contact your chosen supplier before closing with the MPRN from your documents." }
      ],
      contacts: { phone: "+353 21 456 7890", email: "sales@rathardpark.ie", address: "Rathard Park, Bishopstown, Cork" },
      statusMessages: { onTrack: "On Track", delayed: "Slight Delay" }
    };
    
    var nextMilestoneId = 7;
    var nextFaqId = 4;
    var draggedElement = null;
    var draggedIndex = null;
    var currentSheet = null;
    
    // Initialisation
    document.addEventListener('DOMContentLoaded', function() {
      renderMilestones();
      renderFaqs();
      updatePreview();
      updateTimeGreeting();
      setupInputListeners();
      setupButtonListeners();
      setupPhoneListeners();
      setupDragToScroll();
    });
    
    function setupInputListeners() {
      document.getElementById('greeting-input').addEventListener('input', function() {
        config.greeting = this.value;
        document.getElementById('greeting-hint').textContent = this.value;
        updatePreview();
      });
      document.getElementById('intro-input').addEventListener('input', function() { config.introText = this.value; updatePreview(); });
      document.getElementById('ontrack-input').addEventListener('input', function() { config.statusMessages.onTrack = this.value; updatePreview(); });
      document.getElementById('delayed-input').addEventListener('input', function() { config.statusMessages.delayed = this.value; updatePreview(); });
      document.getElementById('phone-input').addEventListener('input', function() { config.contacts.phone = this.value; updatePreview(); });
      document.getElementById('email-input').addEventListener('input', function() { config.contacts.email = this.value; updatePreview(); });
      document.getElementById('address-input').addEventListener('input', function() { config.contacts.address = this.value; updatePreview(); });
      document.getElementById('est-handover-input').addEventListener('change', function() { config.estHandover = this.value; updatePreview(); });
      document.getElementById('snagging-lead-input').addEventListener('change', function() { config.snaggingLead = this.value; updatePreview(); });
      document.getElementById('cal-google').addEventListener('change', function() { config.calendarOptions.google = this.checked; updatePreview(); });
      document.getElementById('cal-apple').addEventListener('change', function() { config.calendarOptions.apple = this.checked; updatePreview(); });
      document.getElementById('cal-outlook').addEventListener('change', function() { config.calendarOptions.outlook = this.checked; updatePreview(); });
    }
    
    function setupButtonListeners() {
      document.getElementById('add-milestone-btn').addEventListener('click', addMilestone);
      document.getElementById('add-faq-btn').addEventListener('click', addFaq);
      document.getElementById('save-btn').addEventListener('click', saveChanges);
      document.getElementById('preview-btn').addEventListener('click', function() { showToast('Opening full preview...'); });
    }
    
    // Phone Preview Interactivity
    function setupPhoneListeners() {
      document.getElementById('btn-timeline').addEventListener('click', function() { openSheet('timeline'); });
      document.getElementById('btn-docs').addEventListener('click', function() { openSheet('docs'); });
      document.getElementById('btn-faq').addEventListener('click', function() { openSheet('faq'); });
      document.getElementById('btn-contact').addEventListener('click', function() { openSheet('contact'); });
      document.getElementById('btn-settings').addEventListener('click', function() { openSheet('settings'); });
      document.getElementById('btn-calendar').addEventListener('click', function() { openSheet('calendar'); });
      document.getElementById('nav-home').addEventListener('click', function() { closeSheet(); setActiveNav('home'); });
      document.getElementById('nav-docs').addEventListener('click', function() { openSheet('docs'); setActiveNav('docs'); });
      document.getElementById('nav-faq').addEventListener('click', function() { openSheet('faq'); setActiveNav('faq'); });
      document.getElementById('phone-backdrop').addEventListener('click', closeSheet);
    }
    
    function openSheet(name) {
      closeSheet();
      currentSheet = name;
      document.getElementById('sheet-' + name).classList.add('open');
      document.getElementById('phone-backdrop').classList.add('open');
      updateSheetContent(name);
    }
    
    function closeSheet() {
      if (currentSheet) document.getElementById('sheet-' + currentSheet).classList.remove('open');
      document.getElementById('phone-backdrop').classList.remove('open');
      document.querySelectorAll('.phone-sheet').forEach(function(s) { s.classList.remove('open'); });
      currentSheet = null;
      setActiveNav('home');
    }
    
    function setActiveNav(name) {
      document.querySelectorAll('.phone-nav-btn').forEach(function(btn) {
        btn.classList.remove('active');
        btn.querySelector('svg').style.color = '#9ca3af';
        btn.querySelector('span').style.color = '#9ca3af';
        btn.querySelector('span').style.fontWeight = '400';
      });
      var activeBtn = document.getElementById('nav-' + name);
      if (activeBtn) {
        activeBtn.classList.add('active');
        activeBtn.querySelector('svg').style.color = '#D4A853';
        activeBtn.querySelector('span').style.color = '#D4A853';
        activeBtn.querySelector('span').style.fontWeight = '600';
      }
    }
    
    function updateSheetContent(name) {
      if (name === 'timeline') {
        var enabledMilestones = config.milestones.filter(function(m) { return m.enabled; });
        var currentIndex = Math.min(3, enabledMilestones.length - 1);
        var html = '';
        for (var i = 0; i < enabledMilestones.length; i++) {
          var m = enabledMilestones[i];
          var isComplete = i < currentIndex;
          var isCurrent = i === currentIndex;
          var isPending = i > currentIndex;
          var opacity = isPending ? 'opacity-50' : '';
          html += '<div class="flex items-center gap-2 p-2 rounded-lg ' + opacity + ' ' + (isCurrent ? 'bg-amber-50' : '') + '">';
          if (isComplete) {
            html += '<div class="w-5 h-5 rounded-full bg-brand-gold flex items-center justify-center"><svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" /></svg></div>';
          } else if (isCurrent) {
            html += '<div class="w-5 h-5 rounded-full border-2 border-brand-gold flex items-center justify-center"><div class="w-2 h-2 rounded-full bg-brand-gold"></div></div>';
          } else {
            html += '<div class="w-5 h-5 rounded-full bg-gray-200 flex items-center justify-center"><div class="w-1.5 h-1.5 rounded-full bg-gray-400"></div></div>';
          }
          html += '<span class="text-[10px] flex-1 ' + (isCurrent ? 'font-semibold text-gray-900' : 'text-gray-600') + '">' + m.label + '</span>';
          if (isCurrent) html += '<span class="text-[8px] text-brand-gold font-medium">Current</span>';
          html += '</div>';
        }
        document.getElementById('sheet-timeline-content').innerHTML = html;
      }
      if (name === 'faq') {
        var html = '';
        if (config.faqs.length === 0) {
          html = '<p class="text-[10px] text-gray-400 text-center py-4">No FAQs configured</p>';
        } else {
          for (var i = 0; i < config.faqs.length; i++) {
            var faq = config.faqs[i];
            if (faq.question) {
              html += '<details class="bg-gray-50 rounded-lg"><summary class="p-2 text-[10px] font-medium text-gray-900 cursor-pointer">' + faq.question + '</summary><div class="px-2 pb-2 text-[9px] text-gray-600">' + (faq.answer || 'No answer provided') + '</div></details>';
            }
          }
        }
        document.getElementById('sheet-faq-content').innerHTML = html;
      }
      if (name === 'contact') {
        var html = '';
        html += '<a href="tel:' + config.contacts.phone + '" class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg"><div class="w-8 h-8 rounded-lg bg-emerald-100 flex items-center justify-center"><svg class="w-4 h-4 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" /></svg></div><div class="flex-1"><p class="text-[10px] font-medium text-gray-900">Call Sales</p><p class="text-[8px] text-gray-500">' + config.contacts.phone + '</p></div></a>';
        html += '<a href="mailto:' + config.contacts.email + '" class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg"><div class="w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center"><svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /></svg></div><div class="flex-1"><p class="text-[10px] font-medium text-gray-900">Email Us</p><p class="text-[8px] text-gray-500">' + config.contacts.email + '</p></div></a>';
        html += '<div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg"><div class="w-8 h-8 rounded-lg bg-violet-100 flex items-center justify-center"><svg class="w-4 h-4 text-violet-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg></div><div class="flex-1"><p class="text-[10px] font-medium text-gray-900">Show House</p><p class="text-[8px] text-gray-500">' + config.contacts.address + '</p></div></div>';
        document.getElementById('sheet-contact-content').innerHTML = html;
      }
      if (name === 'calendar') {
        var html = '';
        var anyEnabled = config.calendarOptions.google || config.calendarOptions.apple || config.calendarOptions.outlook;
        if (!anyEnabled) {
          html = '<p class="text-[10px] text-gray-400 text-center py-4">No calendar options enabled</p>';
        } else {
          if (config.calendarOptions.google) html += '<div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100"><div class="w-8 h-8 rounded-lg bg-white border border-gray-200 flex items-center justify-center"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg></div><div class="flex-1"><p class="text-[10px] font-medium text-gray-900">Google Calendar</p></div><svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5l7 7-7 7" /></svg></div>';
          if (config.calendarOptions.apple) html += '<div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100"><div class="w-8 h-8 rounded-lg bg-white border border-gray-200 flex items-center justify-center"><svg class="w-4 h-4" viewBox="0 0 24 24" fill="#000"><path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/></svg></div><div class="flex-1"><p class="text-[10px] font-medium text-gray-900">Apple Calendar</p></div><svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5l7 7-7 7" /></svg></div>';
          if (config.calendarOptions.outlook) html += '<div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100"><div class="w-8 h-8 rounded-lg bg-white border border-gray-200 flex items-center justify-center"><svg class="w-4 h-4" viewBox="0 0 24 24"><path fill="#0078D4" d="M24 7.387v10.478c0 .23-.08.424-.238.576-.16.154-.354.23-.578.23h-8.547v-6.959l1.203.852c.106.064.217.096.34.096s.234-.032.34-.096L24 7.387zm-.874-.634l-7.41 5.27-7.398-5.27h14.808zM7.5 6h-6C.678 6 0 6.678 0 7.5v9c0 .822.678 1.5 1.5 1.5h6c.822 0 1.5-.678 1.5-1.5v-9c0-.822-.678-1.5-1.5-1.5z"/></svg></div><div class="flex-1"><p class="text-[10px] font-medium text-gray-900">Outlook</p></div><svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5l7 7-7 7" /></svg></div>';
          html += '<div class="flex items-center gap-3 p-2 bg-gray-50 rounded-lg cursor-pointer hover:bg-gray-100 mt-2"><div class="w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center"><svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg></div><div class="flex-1"><p class="text-[10px] font-medium text-gray-900">Download .ics file</p></div><svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 5l7 7-7 7" /></svg></div>';
        }
        document.getElementById('sheet-calendar-content').innerHTML = html;
      }
    }
    
    function updateTimeGreeting() {
      var hour = new Date().getHours();
      var greeting = hour < 12 ? 'Good morning' : hour < 18 ? 'Good afternoon' : 'Good evening';
      document.getElementById('preview-time-greeting').textContent = greeting;
    }
    
    function formatEstMonth(val) {
      if (!val) return 'TBC';
      var parts = val.split('-');
      var months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      return months[parseInt(parts[1]) - 1] + ' ' + parts[0];
    }
    
    // Milestones
    function renderMilestones() {
      var list = document.getElementById('milestone-list');
      var html = '';
      for (var i = 0; i < config.milestones.length; i++) {
        var m = config.milestones[i];
        var isLast = i === config.milestones.length - 1;
        html += '<div class="milestone-item ' + (m.enabled ? '' : 'disabled-item') + '" data-index="' + i + '" draggable="true">';
        html += '<div class="drag-handle text-gray-400"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16" /></svg></div>';
        html += '<input type="text" class="input-field flex-1 milestone-label" data-index="' + i + '" value="' + m.label + '">';
        html += '<button class="toggle ' + (m.enabled ? 'active' : '') + '" data-index="' + i + '"></button>';
        if (!isLast) html += '<button class="delete-btn" data-index="' + i + '"><svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg></button>';
        html += '</div>';
      }
      list.innerHTML = html;
      attachMilestoneListeners();
    }
    
    function attachMilestoneListeners() {
      document.querySelectorAll('.milestone-label').forEach(function(input) {
        input.addEventListener('input', function() { config.milestones[parseInt(this.dataset.index)].label = this.value; updatePreview(); });
      });
      document.querySelectorAll('.milestone-item .toggle').forEach(function(toggle) {
        toggle.addEventListener('click', function() {
          var idx = parseInt(this.dataset.index);
          config.milestones[idx].enabled = !config.milestones[idx].enabled;
          this.classList.toggle('active');
          this.closest('.milestone-item').classList.toggle('disabled-item');
          updatePreview();
        });
      });
      document.querySelectorAll('.milestone-item .delete-btn').forEach(function(btn) {
        btn.addEventListener('click', function() {
          config.milestones.splice(parseInt(this.dataset.index), 1);
          renderMilestones(); updatePreview(); showToast('Milestone removed');
        });
      });
      document.querySelectorAll('.milestone-item').forEach(function(item) {
        item.addEventListener('dragstart', handleDragStart);
        item.addEventListener('dragend', handleDragEnd);
        item.addEventListener('dragover', handleDragOver);
        item.addEventListener('drop', handleDrop);
        item.addEventListener('dragleave', handleDragLeave);
      });
    }
    
    function handleDragStart(e) { draggedElement = this; draggedIndex = parseInt(this.dataset.index); this.classList.add('dragging'); e.dataTransfer.effectAllowed = 'move'; }
    function handleDragEnd(e) { this.classList.remove('dragging'); document.querySelectorAll('.milestone-item').forEach(function(item) { item.classList.remove('drag-over'); }); }
    function handleDragOver(e) { e.preventDefault(); if (this !== draggedElement) this.classList.add('drag-over'); }
    function handleDragLeave(e) { this.classList.remove('drag-over'); }
    function handleDrop(e) {
      e.preventDefault(); this.classList.remove('drag-over');
      if (this !== draggedElement && draggedIndex !== null) {
        var targetIndex = parseInt(this.dataset.index);
        var item = config.milestones.splice(draggedIndex, 1)[0];
        config.milestones.splice(targetIndex, 0, item);
        renderMilestones(); updatePreview(); showToast('Milestone reordered');
      }
    }
    
    function addMilestone() {
      config.milestones.splice(config.milestones.length - 1, 0, { id: nextMilestoneId++, label: "New Milestone", enabled: true });
      renderMilestones(); updatePreview(); showToast('Milestone added');
    }
    
    // FAQs
    function renderFaqs() {
      var list = document.getElementById('faq-list');
      var html = '';
      for (var i = 0; i < config.faqs.length; i++) {
        var faq = config.faqs[i];
        html += '<div class="faq-item" data-index="' + i + '"><div class="flex items-start justify-between mb-2"><label class="block text-sm font-medium text-gray-700">Question ' + (i + 1) + '</label><button class="delete-btn faq-delete" data-index="' + i + '"><svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg></button></div><input type="text" class="input-field mb-2 faq-question" data-index="' + i + '" value="' + faq.question + '" placeholder="Enter question..."><textarea class="textarea-field faq-answer" data-index="' + i + '" rows="2" placeholder="Enter answer...">' + faq.answer + '</textarea></div>';
      }
      if (config.faqs.length === 0) html = '<p class="text-sm text-gray-400 text-center py-4">No FAQs added yet. Click "Add FAQ" to create one.</p>';
      list.innerHTML = html;
      attachFaqListeners();
    }
    
    function attachFaqListeners() {
      document.querySelectorAll('.faq-question').forEach(function(input) { input.addEventListener('input', function() { config.faqs[parseInt(this.dataset.index)].question = this.value; updatePreview(); }); });
      document.querySelectorAll('.faq-answer').forEach(function(textarea) { textarea.addEventListener('input', function() { config.faqs[parseInt(this.dataset.index)].answer = this.value; updatePreview(); }); });
      document.querySelectorAll('.faq-delete').forEach(function(btn) { btn.addEventListener('click', function() { config.faqs.splice(parseInt(this.dataset.index), 1); renderFaqs(); updatePreview(); showToast('FAQ removed'); }); });
    }
    
    function addFaq() {
      config.faqs.push({ id: nextFaqId++, question: "", answer: "" });
      renderFaqs(); showToast('FAQ added');
      setTimeout(function() { var inputs = document.querySelectorAll('.faq-question'); if (inputs.length > 0) inputs[inputs.length - 1].focus(); }, 100);
    }
    
    // Preview Update
    function updatePreview() {
      var enabledMilestones = config.milestones.filter(function(m) { return m.enabled; });
      var currentIndex = Math.min(3, enabledMilestones.length - 1);
      var progress = Math.round(((currentIndex + 1) / enabledMilestones.length) * 100);
      document.getElementById('preview-percent').textContent = progress + '%';
      document.getElementById('preview-progress-bar').style.width = progress + '%';
      var estDisplay = formatEstMonth(config.estHandover);
      document.getElementById('preview-status').textContent = config.statusMessages.onTrack + ' · Est. ' + estDisplay;
      document.getElementById('preview-greeting').innerHTML = config.greeting + ', <strong>Sarah</strong>';
      if (enabledMilestones[currentIndex]) {
        document.getElementById('preview-current-milestone').innerHTML = '<span class="font-medium">' + enabledMilestones[currentIndex].label + '</span><span class="text-gray-400"> · Est. 28 Jan</span>';
      }
      if (currentSheet) updateSheetContent(currentSheet);
    }
    
    // Save & Toast
    function saveChanges() { console.log('Saving:', JSON.stringify(config, null, 2)); showToast('Changes saved successfully!'); }
    function showToast(message) {
      var toast = document.getElementById('toast');
      document.getElementById('toast-message').textContent = message;
      toast.classList.add('show');
      setTimeout(function() { toast.classList.remove('show'); }, 2500);
    }
    
    // Drag to Scroll (Phone Preview)
    function setupDragToScroll() {
      var scrollContainer = document.getElementById('phone-main-content');
      var isDown = false;
      var startY;
      var scrollTop;
      scrollContainer.addEventListener('mousedown', function(e) {
        if (e.target.closest('.phone-action-btn')) return;
        isDown = true;
        scrollContainer.classList.add('dragging');
        startY = e.pageY - scrollContainer.offsetTop;
        scrollTop = scrollContainer.scrollTop;
      });
      scrollContainer.addEventListener('mouseleave', function() { isDown = false; scrollContainer.classList.remove('dragging'); });
      scrollContainer.addEventListener('mouseup', function() { isDown = false; scrollContainer.classList.remove('dragging'); });
      scrollContainer.addEventListener('mousemove', function(e) {
        if (!isDown) return;
        e.preventDefault();
        var y = e.pageY - scrollContainer.offsetTop;
        var walk = (y - startY) * 1.5;
        scrollContainer.scrollTop = scrollTop - walk;
      });
      scrollContainer.addEventListener('touchstart', function(e) { if (e.target.closest('.phone-action-btn')) return; startY = e.touches[0].pageY - scrollContainer.offsetTop; scrollTop = scrollContainer.scrollTop; }, { passive: true });
      scrollContainer.addEventListener('touchmove', function(e) { var y = e.touches[0].pageY - scrollContainer.offsetTop; var walk = (y - startY) * 1.5; scrollContainer.scrollTop = scrollTop - walk; }, { passive: true });
    }
  </script>
</body>
</html>
