You are fixing a keyboard layout bug in an iOS web app running inside Capacitor.

Current problems:
- When the keyboard opens after messages exist, chat messages are hidden behind the input bar and bottom tab bar
- The chat list does not resize when the keyboard appears
- The input bar is positioned in a way that ignores keyboard height
- Layout breaks after sending a message or rotating the device

Your task is to implement a correct, production-grade chat layout.

STRICT REQUIREMENTS:
- Do NOT touch authentication or routing
- Do NOT modify backend APIs
- Do NOT change Capacitor or Xcode settings
- Fix must work for purchaser portal only
- Follow iOS Safari best practices

IMPLEMENT THE FOLLOWING:

1. Keyboard awareness
- In PurchaserChatTab.tsx, add a keyboard state using visualViewport:
  - Track keyboard height as: window.innerHeight - visualViewport.height
  - Update on visualViewport resize events
  - Store keyboardHeight in React state

2. Layout architecture change
- Replace all `position: fixed` usage for:
  - Chat input bar
  - Chat message list
- Use a vertical flex layout instead:
  - Parent container: display: flex; flex-direction: column; height: 100vh
  - Message list: flex: 1; overflow-y: auto
  - Input bar: position: sticky; bottom: 0

3. Keyboard interaction rules
- When keyboardHeight > 0:
  - Hide the MobileTabBar
  - Add bottom padding to the chat container equal to keyboardHeight
- When keyboard closes:
  - Restore the tab bar
  - Remove extra padding

4. Message visibility guarantee
- Ensure the last message is always visible when:
  - Keyboard opens
  - A new message is sent
- Auto-scroll to bottom on message send AND keyboard open

5. Safe area handling
- Respect env(safe-area-inset-bottom)
- Keyboard padding must be additive:
  keyboardHeight + safe-area-inset-bottom

FILES TO MODIFY:
- components/chat/PurchaserChatTab.tsx (main logic)
- components/chat/ChatMessageList.tsx (flex behaviour)
- components/chat/ChatInputBar.tsx (remove fixed positioning)

FILES NOT TO TOUCH:
- globals.css (unless strictly necessary)
- MobileTabBar.tsx logic (only conditional rendering allowed)

DELIVERABLE:
- Chat behaves correctly like iMessage
- No content is hidden behind keyboard
- No overlap with bottom nav
- No glitches after sending messages
- Smooth behaviour on rotation

After implementing, explain briefly:
- What changed
- Why this fixes the issue
