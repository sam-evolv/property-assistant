Context
You are working inside the repository:

property-assistant/apps/unified-portal

This is a production-critical mobile-first resident portal.
The user has already patched app/layout.tsx manually.
You must now audit, refactor, and stabilise everything else so the issue is fixed permanently.

This is a final hardening pass, not experimentation.

NON-NEGOTIABLE RULES

DO NOT

Change routing

Change Supabase queries

Change auth logic

Change theme tokens, colours, or branding

Introduce new libraries

Break desktop layout

Add scroll to the landing/chat screen

YOU MAY

Refactor layout wrappers

Refactor chat UI components

Adjust spacing, padding, border-radius, shadows

Improve message bubble UX

Improve input bar UX

Improve mobile keyboard behaviour

Improve perceived quality and polish

PRIMARY GOALS

Fix layout issues once and for all

Eliminate unintended scrolling

Lock bottom navigation permanently

Make chat feel iMessage-like, premium, calm, and modern

Preserve OpenHouseAi dark cinematic theme

PHASE 1 — LAYOUT HARD RESET (CRITICAL)
Objective

Ensure one and only one scroll context, with fixed header + fixed bottom nav.

Tasks

Audit layout hierarchy

Identify all wrappers contributing to height or scroll:

app/layout.tsx

app/page.tsx

components/layout/*

ChatLayout, MainLayout, etc.

Remove nested h-screen, min-h-screen, overflow-y-auto conflicts

Enforce canonical layout contract

Root container:

height: 100dvh;
overflow: hidden;


Content area:

flex: 1;
overflow: hidden;


Chat message list:

overflow-y: auto;
overscroll-behavior: none;


Bottom navigation

Must be:

position: fixed;
bottom: 0;
left: 0;
right: 0;


Zero layout shift

No reflow on keyboard open

No overlap with chat input

Hard lock

The landing/chat screen must not scroll

Only the message list scrolls

PHASE 2 — CHAT INTERFACE UX UPGRADE (iMessage-INSPIRED)
Objective

Make the chat feel familiar, calm, premium, without copying Apple or changing brand identity.

Apply these principles:
Message Bubbles

Rounded rectangles, asymmetric

Incoming:

Slightly lighter dark surface

Left-aligned

Outgoing:

Subtle gold-tinted dark

Right-aligned

Max width: ~75%

Comfortable line height

No harsh borders

Message Stack

Vertical rhythm similar to iMessage

Gentle spacing between groups

Avatar optional, minimal, non-dominant

Input Bar (Critical)

Fixed above bottom nav

Rounded pill container

Soft shadow / glass feel

No hard edges

Keyboard-safe on iOS

Example behaviour:

When keyboard opens:

Input rises

Messages resize

No jumping

No double padding

PHASE 3 — MOBILE KEYBOARD & SAFE AREA FIXES
Objective

No glitches on iOS Safari or Chrome.

Tasks

Use 100dvh instead of 100vh

Respect safe areas:

padding-bottom: env(safe-area-inset-bottom);


Prevent viewport resize bugs

Ensure focus on input does NOT:

Push entire layout

Break bottom nav

Create ghost scroll

PHASE 4 — VISUAL POLISH (NO BRAND CHANGE)
Improve perceived quality:

Micro-shadows

Subtle gradients

Motion smoothing (CSS only)

Consistent spacing tokens

Remove visual noise

Explicitly preserve:

Dark cinematic theme

Existing colour tokens

Gold accent usage

Typography scale

PHASE 5 — VERIFICATION CHECKLIST (MANDATORY)

Before finishing, verify:

 No scroll on landing/chat screen

 Only message list scrolls

 Bottom nav never moves

 Keyboard does not break layout

 Chat feels iMessage-level polished

 Desktop layout unchanged

 No console errors

 No Supabase or routing changes

OUTPUT REQUIREMENTS

When finished, respond with:

Summary of changes

Files modified

Why this will not regress

Any remaining known constraints (if any)

Do not ask follow-up questions.
Execute decisively and cleanly.

If you want, next we can:

Add message grouping intelligence

Add typing indicators

Add subtle haptic-like motion

Add contextual system messages

But first this must be rock solid.